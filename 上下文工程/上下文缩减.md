### 一、上下文缩减（Reduction）工程实践
1. **触发器：“前腐烂阈值 (Pre-rot threshold)”**
   这不是模型的硬性上限，而是其**性能开始显著下降的点**（通常在**128K-200K**），是触发上下文缩减（Context Reduction）的“警报线”。

2. **分步执行，优先级明确**
   - 第一步：优先且反复使用**“压缩 (Compaction)”**。当上下文触及“警报线”时，系统首先尝试此操作。
   - 第二步：当“压缩”收益过小时，才使用**“摘要 (Summarization)”**。只有在这种情况下，系统才会启用“摘要”这个“大招”。

3. **两个至关重要的执行细节**
   - 保留Few-shot示例：执行“压缩 (Compaction)”时，**只对最旧的50%历史操作**，并保留最新的工具调用记录的**完整格式**。这能为模型提供新鲜的Few-shot示例，防止它模仿并输出错误的紧凑格式。
   - 摘要的数据源与平滑过渡：执行“摘要 (Summarization)”时，必须基于**完整版本**的数据进行提炼（而非已压缩版）。同时，也要**保留最后几个工具调用的完整细节**，让模型知道它从哪里中断，从而平滑地继续任务。


### 二、上下文缩减（Context Reduction）新视角：可逆 vs. 不可逆
| 维度         | 压缩 (Compaction) | 摘要 (Summarization) |
|--------------|-------------------|----------------------|
| 原理/定位    | 可逆的、无损的外部化；去除可从文件系统或外部状态中重建的信息，用轻量级“指针”代替 | 当“压缩”收益过小时启用的有损、不可逆操作 |
| 示例         | 写文件：`{path, content}` → `{path}`；浏览器：网页全文HTML → URL | - |
| Manus新实践  | - | 先卸载，再摘要：在执行摘要前，将即将被总结的**完整上下文历史**写入日志文件，为“不可逆”操作买“保险”，确保原始信息可回溯 |
| 核心价值/风险 | 核心价值：**100%信息保真** | 核心风险：**仍可能丢失细节** |
