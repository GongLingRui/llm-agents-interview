https://blog.langchain.com/how-agents-can-use-filesystems-for-context-engineering/


# 网页总结：智能体如何利用文件系统进行上下文构建
## 一、核心背景
1. **深度智能体关键特性**：深度智能体可借助文件系统工具，执行文件读取、写入、编辑、列出及搜索等操作，这是其区别于普通智能体的重要能力。
2. **智能体失败原因**：当前智能体失败多源于两点，一是模型本身性能不足，二是无法获取正确的上下文；而上下文工程是为下一步在上下文窗口填充合适信息的“精妙艺术与科学”，理解它及可能的失效情况，对构建可靠智能体至关重要。


## 二、上下文工程视角与失效场景
### （一）上下文工程核心逻辑
现代智能体工程师的工作可从上下文工程视角理解：智能体通常能获取大量上下文（如所有支持文档、代码文件等），为回答问题需特定重要上下文，且会检索部分上下文拉入自身上下文窗口。

### （二）上下文工程失效的3种情况
|失效类型|具体表现|示例|
| ---- | ---- | ---- |
|所需上下文缺失|智能体所需上下文不在整体可获取的上下文中|客户支持智能体需某文档页面答题，但该页面未被索引|
|检索上下文不完整|检索到的上下文未涵盖所需上下文|上述文档页面存在且已索引，但智能体未检索到|
|检索上下文冗余|检索到的上下文远多于所需上下文|智能体仅需1个特定页面，却检索了100个页面，浪费时间与令牌|

### （三）分离合适上下文的4大挑战
1. **令牌过多**：部分工具（如网络搜索）返回大量令牌，易导致对话历史令牌累积，引发400错误请求，还会增加大模型使用成本、降低性能。
2. **需大量上下文**：智能体回答问题可能需大量信息，单次搜索无法获取，需反复调用搜索工具，但上下文总量会超出上下文窗口承载能力。
3. **难寻小众信息**：智能体可能需从成百上千个文件中挖掘小众信息，若无法可靠找到，检索的上下文将无法满足答题需求，且暂缺语义搜索的完美替代或补充方案。
4. **难随时间学习**：智能体可能无法获取答题所需必要上下文，而用户在交互中会提供相关线索，但缺乏将线索纳入后续上下文的有效方式。


## 三、文件系统对智能体的优化作用
文件系统为智能体提供单一接口，支持灵活存储、检索和更新无限量上下文，可针对性解决上述挑战：

### （一）解决“令牌过多”问题
智能体无需在对话历史中存储工具调用结果和笔记，可将其写入文件系统，需用时仅选择性查找相关信息。例如，网络搜索获取的10k令牌原始内容，仅在需要时通过关键词搜索读取必要部分，避免令牌浪费与成本增加，此时文件系统相当于“大型上下文临时记录区”。

### （二）应对“需大量上下文”需求
文件系统提供抽象能力，允许大语言模型动态存储和提取信息，典型场景包括：
- 长周期任务中，智能体将计划写入文件系统，后续可重新纳入上下文窗口，明确任务方向（如“通过复述引导注意力”）。
- 启动子智能体梳理上下文时，子智能体可将知识写入文件系统，而非仅向主智能体回复，减少信息传递失真。
- 智能体所需大量操作指令可存储为文件，需用时动态读取，避免系统提示中指令过多导致上下文臃肿（如Anthropic技能存储）。

### （三）助力“寻找小众信息”
相较于语义搜索在技术API参考、代码文件等场景中因缺乏语义信息而效果不佳的问题，文件系统支持智能体用ls、glob、grep等工具搜索：
- 现有模型经专门训练，可理解文件系统遍历逻辑。
- 文件按目录逻辑结构化，便于定位。
- glob和grep能精准定位特定文件、行甚至字符，结合`read_file`工具可指定读取文件行数。同时，语义搜索仍有价值，可与文件系统搜索结合使用（如Cursor博客提及的协同优势）。

### （四）支持“随时间学习”
用户是领域专家，在交互中会提供上下文线索，文件系统可作为智能体存储和更新自身指令的载体：
- 接收用户反馈后，智能体可立即将重要信息（如用户姓名、邮箱、偏好等定制化内容）写入文件，用于后续交互。
- 该模式虽未完全成熟，但为大语言模型逐步拓展技能集、确保后续获取必要上下文提供了新路径。


## 四、相关资源与后续参与
1. **开源项目**：提供Deep Agents开源代码库（支持Python、TypeScript），内置多种基于文件系统的上下文工程技巧，可快速构建支持文件系统访问的智能体。
2. **社区互动**：鼓励尝试Deep Agents并反馈使用体验，同时可订阅LangChain团队和社区的新闻通讯，获取最新动态。
