<img width="1251" height="927" alt="image" src="https://github.com/user-attachments/assets/56a1d5e7-4532-41e3-8ac6-ca7e52b9aba3" />


# 一、整体架构概览
这是一张**AI驱动的浏览器自动化/智能代理技术栈架构图**，它清晰划分了从上层应用到底层浏览器协议的完整技术链路，核心是为AI代理提供操作浏览器的标准化能力，实现网页交互的自动化与智能化。
整个架构自顶向下分为四个核心层级：
- **L0：应用/产品与集成层**
- **L1：编排层（Orchestration Layer）**
- **L2：执行层（Execution Layer）**
- **L3：协议/驱动/浏览器层**

---

# 二、分层功能详解

## L0：应用/产品与集成层
这是架构的最顶层，是面向用户或业务的具体产品形态，它们都依赖底层的编排与执行能力来实现功能。
- **Agent Wrapper**：如 HyperAgent、PageAgent 等，是给大模型的“操作浏览器”能力做封装的工具，让大模型能调用浏览器完成任务。
- **Browser Infrastructure**：如 Browserbase、Steel-dev 等，是提供云端浏览器实例的基础设施，解决本地浏览器不稳定、资源不足的问题。
- **AI Browser**：如 ChatGPT Atlas、Perplexity Comet 等，是集成了AI能力的浏览器，可理解用户意图并自动操作网页。
- **Chrome Extension**：如 Claude、AntiGravity 等浏览器插件，直接在浏览器中提供AI辅助功能，依赖扩展连接工具与底层通信。
- **Playwright/Puppeteer/CDP**：如 Cursor、Replit Agent 等，基于自动化框架的开发者工具，用于快速构建网页自动化脚本。
- **Computer-use**：如 ezb-surf、AutoGLM 等，是更通用的“计算机使用”AI代理，把浏览器操作作为控制电脑的核心手段之一。

---

## L1：编排层（Orchestration Layer）
这是整个架构的**大脑和调度中心**，负责接收上层应用的指令，选择最优工具并分发给执行层。
- **Agent / Infra / SDK（核心逻辑）**：作为统一入口，接收来自L0层所有产品的请求，处理鉴权、流量控制等基础逻辑。
- **工具调度中心**：核心决策模块，会根据任务类型（如网页爬取、表单填写、视觉交互）选择最合适的执行工具，例如：
  - 传统网页自动化 → 分配给 WebDriver Tool
  - 现代浏览器高保真控制 → 分配给 Playwright/Puppeteer Tool
  - 浏览器插件通信 → 分配给 Extension Connect Tool
  - 无障碍树交互 → 分配给 Accessibility Tool
  - 视觉识别交互 → 分配给 Vision Tool
  - 底层协议操作 → 分配给 CDP Tool

---

## L2：执行层（Execution Layer）
这是架构的**执行器**，它将L1层的调度指令转化为具体的浏览器操作，并管理不同技术路径的执行。
- **核心工具实现**：
  - `Selenium`：通过 WebDriver 协议控制浏览器，是最成熟的跨浏览器自动化方案。
  - `Playwright`：新一代自动化框架，支持多浏览器，稳定性和速度更优。
  - `Puppeteer`：专注于Chrome/Chromium的自动化工具，API简洁易用。
  - `chromedebugger`：Chrome DevTools的调试工具，可直接操作浏览器的调试接口。
  - `cdp-use`：直接使用Chrome DevTools Protocol（CDP）进行底层操作。
- **执行路径选择**：
  - **A11y执行路径**：通过浏览器的无障碍树（Accessibility Tree）识别元素，适合对DOM结构不友好但无障碍支持良好的页面。
  - **视觉执行路径**：通过计算机视觉识别页面元素，是兜底方案，适合复杂渲染页面（如Canvas、动态生成内容）。

---

## L3：协议/驱动/浏览器层
这是架构的**最底层**，直接与浏览器内核交互，是所有上层能力的技术基础。
- **协议层**：
  - `W3C WebDriver`：W3C标准协议，Selenium等工具的基础，跨浏览器兼容。
  - `Playwright protocol`：Playwright自研的更高效的浏览器控制协议。
  - `chrome.debugger API`：Chrome浏览器提供的调试接口，可直接操作浏览器进程。
  - `CDP (WebSocket)`：Chrome DevTools Protocol，通过WebSocket实现双向通信，是最底层的控制协议。
- **浏览器实体**：
  - 支持 Chrome、Firefox、Safari、Edge 等主流浏览器，负责渲染网页、执行JavaScript，并提供DOM、渲染树、无障碍树等核心数据结构。
- **网页运行时**：
  - 包含DOM树、渲染树、无障碍树和视觉截图，是浏览器执行网页代码后生成的核心产物，为上层操作提供目标。

---

# 三、核心价值与技术亮点
1. **分层解耦**：通过清晰的层级划分，让上层应用与底层浏览器技术解耦，可快速适配新的浏览器和自动化框架。
2. **多路径容错**：提供了协议控制、无障碍树、视觉识别等多种执行路径，确保在复杂网页场景下也能稳定完成任务。
3. **AI原生设计**：整个架构围绕AI代理的需求设计，支持大模型通过自然语言指令驱动浏览器，实现真正的智能网页交互。

如果你需要，我可以帮你梳理一份**核心技术链路流程图**，直观展示从一个AI指令发出到浏览器完成操作的完整过程。需要吗？
